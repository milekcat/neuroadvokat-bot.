import os
import logging
from dotenv import load_dotenv
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, CallbackQueryHandler, MessageHandler, filters, ContextTypes
from telegram.constants import ParseMode
from telegram.helpers import escape_markdown

# --- 1. –ù–ê–°–¢–†–û–ô–ö–ê ---
logging.basicConfig(format="%(asctime)s - %(name)s - %(levelname)s - %(message)s", level=logging.INFO)
logger = logging.getLogger(__name__)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ .env
load_dotenv()

NEURO_ADVOCAT_TOKEN = os.environ.get('NEURO_ADVOCAT_TOKEN')
TELEGRAM_CHANNEL_URL = os.environ.get('TELEGRAM_CHANNEL_URL')
MANAGER_USER_ID = "8319092960" 

# –ù–û–í–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –ü–ê–†–¢–ù–ï–†–ê
PARTNER_VK_URL = "https://vk.com/club227427328"
PARTNER_TG_URL = "https://t.me/budem_jit_fond" # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π Telegram-–∫–∞–Ω–∞–ª —Ñ–æ–Ω–¥–∞

if not all([NEURO_ADVOCAT_TOKEN, TELEGRAM_CHANNEL_URL]):
    logger.critical("FATAL ERROR: Could not find variables in .env file or environment.")
    exit(1)

# --- 2. –¢–ï–ö–°–¢–´ –ò –ö–û–ù–°–¢–ê–ù–¢–´ ---
LEGAL_POLICY_TEXT = r"""
üìÑ *–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏*

1\.  *–û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è*
    1.1. –ù–∞—Å—Ç–æ—è—â–∞—è –ü–æ–ª–∏—Ç–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∑–∞—â–∏—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–¥–∞–ª–µ–µ ‚Äì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏) –°–µ—Ä–≤–∏—Å–∞ ¬´–ù–µ–π—Ä–æ-–ê–¥–≤–æ–∫–∞—Ç¬ª (–¥–∞–ª–µ–µ ‚Äì –°–µ—Ä–≤–∏—Å).
    1.2. *–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –°–µ—Ä–≤–∏—Å–∞ –æ–∑–Ω–∞—á–∞–µ—Ç –±–µ–∑–æ–≥–æ–≤–æ—Ä–æ—á–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω–∞—Å—Ç–æ—è—â–µ–π –ü–æ–ª–∏—Ç–∏–∫–æ–π –∏ —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤ –Ω–µ–π —É—Å–ª–æ–≤–∏—è–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.* –í —Å–ª—É—á–∞–µ –Ω–µ—Å–æ–≥–ª–∞—Å–∏—è —Å —ç—Ç–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–æ–∑–¥–µ—Ä–∂–∞—Ç—å—Å—è –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –°–µ—Ä–≤–∏—Å–∞.

2\.  *–°–æ—Å—Ç–∞–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö*
    2.1. –°–µ—Ä–≤–∏—Å —Å–æ–±–∏—Ä–∞–µ—Ç –∏ —Ö—Ä–∞–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
    - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Telegram User ID).
    - –õ—é–±—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ñ–∞–π–ª—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä—è–º–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º –°–µ—Ä–≤–∏—Å–∞.

3\.  *–¶–µ–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö*
    3.1. –î–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å —Ü–µ–ª—å—é –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É—Å–ª—É–≥ –°–µ—Ä–≤–∏—Å–∞, –∞ –∏–º–µ–Ω–Ω–æ ‚Äì –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –µ–≥–æ —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

4\.  *–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö*
    4.1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–∑–Ω–∞–µ—Ç –∏ —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è, —á—Ç–æ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ (–ò–ò) –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.
    4.2. *–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –°–µ—Ä–≤–∏—Å–∞ –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏—Ö –ø–µ—Ä–µ–¥–∞—á–µ —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É Telegram.*
"""
LEGAL_DISCLAIMER_TEXT = r"""
‚ö†Ô∏è *–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (Disclaimer)*

1\.  *–°—Ç–∞—Ç—É—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã—Ö —É—Å–ª—É–≥*
    1.1. –°–µ—Ä–≤–∏—Å ¬´–ù–µ–π—Ä–æ-–ê–¥–≤–æ–∫–∞—Ç¬ª —è–≤–ª—è–µ—Ç—Å—è *–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–¥—É–∫—Ç–æ–º*. –ï–≥–æ –∑–∞–¥–∞—á–∞ ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ *–ø—Ä–æ–µ–∫—Ç–æ–≤ (—à–∞–±–ª–æ–Ω–æ–≤)* —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–∞–Ω–Ω—ã—Ö.
    1.2. *–£—Å–ª—É–≥–∏ –°–µ—Ä–≤–∏—Å–∞ –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–º –¥–æ–∫—É–º–µ–Ω—Ç—ã –ù–ï –Ø–í–õ–Ø–Æ–¢–°–Ø —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–µ–π, —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –∑–∞–∫–ª—é—á–µ–Ω–∏–µ–º –∏–ª–∏ –∞–¥–≤–æ–∫–∞—Ç—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.* –≠—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø–æ –∑–∞–¥–∞–Ω–∏—é –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

2\.  *–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–π*
    2.1. –°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —É—Å–ª–æ–≤–∏—è—Ö *¬´–ö–ê–ö –ï–°–¢–¨¬ª (‚ÄúAS IS‚Äù)*.
    2.2. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –°–µ—Ä–≤–∏—Å–∞ *–Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π* –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ —Ç–æ–≥–æ, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –±—É–¥—É—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏—è–º –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

3\.  *–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è*
    3.1. *–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ—Å–µ—Ç –ø–æ–ª–Ω—É—é, –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—É—é –∏ –µ–¥–∏–Ω–æ–ª–∏—á–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å* –∑–∞ –ª—é–±–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ, –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –∏ –ø–æ–¥–∞—á—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –°–µ—Ä–≤–∏—Å–∞.
    3.2. *–ü–µ—Ä–µ–¥ –ª—é–±—ã–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—è–∑–∞–Ω —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∏/–∏–ª–∏ –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —é—Ä–∏—Å—Ç–æ–º.*
"""
LEGAL_OFERTA_TEXT = r"""
üìë *–î–æ–≥–æ–≤–æ—Ä –ø—É–±–ª–∏—á–Ω–æ–π –æ—Ñ–µ—Ä—Ç—ã*

–ù–∞—Å—Ç–æ—è—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º (–ø—É–±–ª–∏—á–Ω–æ–π –æ—Ñ–µ—Ä—Ç–æ–π) –°–µ—Ä–≤–∏—Å–∞ ¬´–ù–µ–π—Ä–æ-–ê–¥–≤–æ–∫–∞—Ç¬ª (–¥–∞–ª–µ–µ ‚Äì –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å) –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —É—Å–ª—É–≥.

1\.  *–¢–µ—Ä–º–∏–Ω—ã*
    - *–ê–∫—Ü–µ–ø—Ç –û—Ñ–µ—Ä—Ç—ã* ‚Äì –ø–æ–ª–Ω–æ–µ –∏ –±–µ–∑–æ–≥–æ–≤–æ—Ä–æ—á–Ω–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ –û—Ñ–µ—Ä—Ç—ã –ø—É—Ç–µ–º –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏, –≤–µ–¥—É—â–µ–π –∫ –Ω–∞—á–∞–ª—É –¥–∏–∞–ª–æ–≥–∞ —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º (¬´–ù–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥ —Å –î–∏—Ä–∏–∂–µ—Ä–æ–º¬ª).
    - *–ó–∞–∫–∞–∑—á–∏–∫* ‚Äì –ª—é–±–æ–µ –ª–∏—Ü–æ, —Å–æ–≤–µ—Ä—à–∏–≤—à–µ–µ –ê–∫—Ü–µ–ø—Ç –û—Ñ–µ—Ä—Ç—ã.
    - *–£—Å–ª—É–≥–∞* ‚Äì –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —É—Å–ª—É–≥ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ –∑–∞–¥–∞–Ω–∏—é –ó–∞–∫–∞–∑—á–∏–∫–∞.

2\.  *–ü—Ä–µ–¥–º–µ—Ç –¥–æ–≥–æ–≤–æ—Ä–∞*
    2.1\. –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ–±—è–∑—É–µ—Ç—Å—è –æ–∫–∞–∑–∞—Ç—å –ó–∞–∫–∞–∑—á–∏–∫—É –£—Å–ª—É–≥—É, –∞ –ó–∞–∫–∞–∑—á–∏–∫ ‚Äì –ø—Ä–∏–Ω—è—Ç—å –∏ –æ–ø–ª–∞—Ç–∏—Ç—å –µ–µ.
    2.2\. *–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –£—Å–ª—É–≥–∏ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞.* –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∫–∞–∫–∏—Ö-–ª–∏–±–æ —Ü–µ–ª–µ–π –ó–∞–∫–∞–∑—á–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–∏–≥—Ä—ã—à –≤ —Å—É–¥–µ).

3\.  *–ü–æ—Ä—è–¥–æ–∫ –æ–∫–∞–∑–∞–Ω–∏—è –∏ –æ–ø–ª–∞—Ç—ã*
    3.1\. –ù–∞—Å—Ç–æ—è—â–∏–π –¥–æ–≥–æ–≤–æ—Ä —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–∫–ª—é—á–µ–Ω–Ω—ã–º —Å –º–æ–º–µ–Ω—Ç–∞ –ê–∫—Ü–µ–ø—Ç–∞ –û—Ñ–µ—Ä—Ç—ã –ó–∞–∫–∞–∑—á–∏–∫–æ–º.
    3.2\. –°—Ç–æ–∏–º–æ—Å—Ç—å –£—Å–ª—É–≥–∏ —è–≤–ª—è–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç *3500 (—Ç—Ä–∏ —Ç—ã—Å—è—á–∏ –ø—è—Ç—å—Å–æ—Ç) —Ä—É–±–ª–µ–π*.
    3.3\. –û–ø–ª–∞—Ç–∞ –£—Å–ª—É–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ó–∞–∫–∞–∑—á–∏–∫–æ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –º–∞–∫–µ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. *–í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (.docx) –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è.*

4\.  *–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —Å—Ç–æ—Ä–æ–Ω*
    4.1\. *–°–æ–≤–æ–∫—É–ø–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –ø–æ –Ω–∞—Å—Ç–æ—è—â–µ–º—É –î–æ–≥–æ–≤–æ—Ä—É –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è —Å—É–º–º–æ–π –ø–ª–∞—Ç–µ–∂–∞, —É–ø–ª–∞—á–µ–Ω–Ω–æ–≥–æ –ó–∞–∫–∞–∑—á–∏–∫–æ–º –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –£—Å–ª—É–≥—É.*
    4.2\. –í—Å–µ —Å–ø–æ—Ä—ã —Ä–µ—à–∞—é—Ç—Å—è –ø—É—Ç–µ–º –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤. –ü—Ä–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏—è —Å–ø–æ—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –≤ —Å—É–¥ –ø–æ –º–µ—Å—Ç—É –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è.
"""
SERVICE_DESCRIPTIONS = {
    "civil": r"‚öñÔ∏è *–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ –ø—Ä–∞–≤–æ: –ó–∞—â–∏—Ç–∞ –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏*\n\n–î–ª—è –∫–∞–∂–¥–æ–≥–æ, –∫—Ç–æ —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å—é: –ø—Ä–æ–¥–∞–ª–∏ –±—Ä–∞–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä, –Ω–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–¥–µ–ª–∞–ª–∏ —Ä–µ–º–æ–Ω—Ç, —Ö–∏–º—á–∏—Å—Ç–∫–∞ –∏—Å–ø–æ—Ä—Ç–∏–ª–∞ –≤–µ—â—å, —Å—Ç—Ä–∞—Ö–æ–≤–∞—è –∑–∞–Ω–∏–∂–∞–µ—Ç –≤—ã–ø–ª–∞—Ç—É –ø–æ –î–¢–ü, —Å–æ—Å–µ–¥–∏ –∑–∞—Ç–æ–ø–∏–ª–∏ –∫–≤–∞—Ä—Ç–∏—Ä—É.\n\n**–ú—ã –≥–æ—Ç–æ–≤–∏–º:**\n‚Ä¢ *–ü—Ä–µ—Ç–µ–Ω–∑–∏–∏:* –≥—Ä–∞–º–æ—Ç–Ω—ã–π –¥–æ—Å—É–¥–µ–±–Ω—ã–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –±–µ–∑ —Å—É–¥–∞.\n‚Ä¢ *–ò—Å–∫–æ–≤—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è:* –æ –≤–æ–∑–≤—Ä–∞—Ç–µ –¥–µ–Ω–µ–≥, –≤–∑—ã—Å–∫–∞–Ω–∏–∏ –Ω–µ—É—Å—Ç–æ–π–∫–∏, –≤–æ–∑–º–µ—â–µ–Ω–∏–∏ —É—â–µ—Ä–±–∞ –∏ –º–æ—Ä–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–¥–∞.\n‚Ä¢ *–ó–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ —Å—É–¥–µ–±–Ω—ã–π –ø—Ä–∏–∫–∞–∑:* –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–∑—ã—Å–∫–∞–Ω–∏—è –±–µ—Å—Å–ø–æ—Ä–Ω—ã—Ö –¥–æ–ª–≥–æ–≤.",
    "family": r"üë®‚Äçüë©‚Äçüëß‚Äçüë¶ *–°–µ–º–µ–π–Ω–æ–µ –ø—Ä–∞–≤–æ: –î–µ–ª–∏–∫–∞—Ç–Ω–∞—è –ø–æ–º–æ—â—å*\n\n–î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã.\n\n**–ú—ã –≥–æ—Ç–æ–≤–∏–º:**\n‚Ä¢ *–ò—Å–∫–æ–≤—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è –æ –≤–∑—ã—Å–∫–∞–Ω–∏–∏ –∞–ª–∏–º–µ–Ω—Ç–æ–≤:* –∫–∞–∫ –≤ % –æ—Ç –¥–æ—Ö–æ–¥–∞, —Ç–∞–∫ –∏ –≤ —Ç–≤–µ—Ä–¥–æ–π –¥–µ–Ω–µ–∂–Ω–æ–π —Å—É–º–º–µ (–µ—Å–ª–∏ –¥–æ—Ö–æ–¥ ¬´—Å–µ—Ä—ã–π¬ª).\n‚Ä¢ *–ó–∞—è–≤–ª–µ–Ω–∏—è –æ —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–∏ –±—Ä–∞–∫–∞* (–µ—Å–ª–∏ –Ω–µ—Ç —Å–ø–æ—Ä–∞ –æ –¥–µ—Ç—è—Ö –∏ –∏–º—É—â–µ—Å—Ç–≤–µ).\n‚Ä¢ *–ü—Ä–æ–µ–∫—Ç—ã —Å–æ–≥–ª–∞—à–µ–Ω–∏–π –æ–± —É–ø–ª–∞—Ç–µ –∞–ª–∏–º–µ–Ω—Ç–æ–≤:* –¥–ª—è –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–≥–æ –Ω–æ—Ç–∞—Ä–∏–∞–ª—å–Ω–æ–≥–æ –∑–∞–≤–µ—Ä–µ–Ω–∏—è.",
    "housing": r"üè† *–ñ–∏–ª–∏—â–Ω–æ–µ –ø—Ä–∞–≤–æ: –í–∞—à –¥–æ–º ‚Äî –≤–∞—à–∞ –∫—Ä–µ–ø–æ—Å—Ç—å*\n\n–î–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –∏ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ä—é—Ç—Å—è —Å –±–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ–º –£–ö, —Ä–µ—à–∞—é—Ç —Å–ø–æ—Ä—ã —Å —Å–æ—Å–µ–¥—è–º–∏ –∏–ª–∏ —Ö–æ—Ç—è—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Å–¥–µ–ª–∫—É.\n\n**–ú—ã –≥–æ—Ç–æ–≤–∏–º:**\n‚Ä¢ *–ñ–∞–ª–æ–±—ã:* –≤ –£–ø—Ä–∞–≤–ª—è—é—â—É—é –∫–æ–º–ø–∞–Ω–∏—é, –ñ–∏–ª–∏—â–Ω—É—é –∏–Ω—Å–ø–µ–∫—Ü–∏—é, –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä.\n‚Ä¢ *–ò—Å–∫–æ–≤—ã–µ –∑–∞—è–≤–ª–µ–Ω–∏—è:* –æ–± –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –ø–æ—Ä—è–¥–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–≤–∞—Ä—Ç–∏—Ä–æ–π, –æ –Ω–µ—á–∏–Ω–µ–Ω–∏–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π.\n‚Ä¢ *–ü—Ä–æ–µ–∫—Ç—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤:* –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏, –¥–∞—Ä–µ–Ω–∏—è, –∞—Ä–µ–Ω–¥—ã (–Ω–∞–π–º–∞) —Å —É—á–µ—Ç–æ–º –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.",
    "military": r"üõ°Ô∏è *–í–æ–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ –∏ —Å–æ—Ü–æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞—â–∏—Ç–Ω–∏–∫–æ–≤*\n\n–î–ª—è –≤–æ–µ–Ω–Ω–æ—Å–ª—É–∂–∞—â–∏—Ö (–≤–∫–ª—é—á–∞—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –°–í–û), –≤–µ—Ç–µ—Ä–∞–Ω–æ–≤ –∏ –∏—Ö —Å–µ–º–µ–π, —Å—Ç–æ–ª–∫–Ω—É–≤—à–∏—Ö—Å—è —Å –±—é—Ä–æ–∫—Ä–∞—Ç–∏–µ–π.\n\n**–ú—ã –≥–æ—Ç–æ–≤–∏–º:**\n‚Ä¢ *–ó–∞–ø—Ä–æ—Å—ã –∏ —Ä–∞–ø–æ—Ä—Ç—ã:* –≤ –≤–æ–µ–Ω–∫–æ–º–∞—Ç—ã, –≤/—á, –ï–†–¶ –ú–û –†–§ –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞, –≤—ã–ø–ª–∞—Ç, –Ω–∞–≥—Ä–∞–¥.\n‚Ä¢ *–ó–∞—è–≤–ª–µ–Ω–∏—è:* –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ–≤, –∏–º–µ—é—â–∏—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—á–∞—Å—Ç–∏—è –≤ –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö).\n‚Ä¢ *–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏—Å–∫–∏:* –¥–ª—è –æ–±–∂–∞–ª–æ–≤–∞–Ω–∏—è –æ—Ç–∫–∞–∑–æ–≤ –≤ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –≤—ã–ø–ª–∞—Ç –∏ —Å—Ç–∞—Ç—É—Å–æ–≤.",
    "admin": r"üè¢ *–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∞–≤–æ: –ë–æ—Ä—å–±–∞ —Å –±—é—Ä–æ–∫—Ä–∞—Ç–∏–µ–π*\n\n–î–ª—è –≥—Ä–∞–∂–¥–∞–Ω, —Å—Ç–æ–ª–∫–Ω—É–≤—à–∏—Ö—Å—è —Å –Ω–µ–∑–∞–∫–æ–Ω–Ω—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ —á–∏–Ω–æ–≤–Ω–∏–∫–æ–≤ –∏–ª–∏ –ø–æ–ª—É—á–∏–≤—à–∏—Ö –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–π —à—Ç—Ä–∞—Ñ.\n\n**–ú—ã –≥–æ—Ç–æ–≤–∏–º:**\n‚Ä¢ *–ñ–∞–ª–æ–±—ã:* –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è/–±–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–Ω—ã—Ö –ª–∏—Ü –≤ –ø—Ä–æ–∫—É—Ä–∞—Ç—É—Ä—É –∏–ª–∏ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–µ –æ—Ä–≥–∞–Ω—ã.\n‚Ä¢ *–ó–∞—è–≤–ª–µ–Ω–∏—è:* –≤ –†–æ—Å–ø–æ—Ç—Ä–µ–±–Ω–∞–¥–∑–æ—Ä, –¢—Ä—É–¥–æ–≤—É—é –∏–Ω—Å–ø–µ–∫—Ü–∏—é.\n‚Ä¢ *–•–æ–¥–∞—Ç–∞–π—Å—Ç–≤–∞ –∏ –∂–∞–ª–æ–±—ã:* –ø–æ –¥–µ–ª–∞–º –æ–± –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–µ–Ω–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–º–µ–Ω—ã —à—Ç—Ä–∞—Ñ–∞ –ì–ò–ë–î–î).",
    "business": r"üíº *–î–ª—è –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ –∏ —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã—Ö: –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —â–∏—Ç*\n\n–î–ª—è —Ñ—Ä–∏–ª–∞–Ω—Å–µ—Ä–æ–≤ –∏ –Ω–µ–±–æ–ª—å—à–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω—ã –Ω–∞–¥–µ–∂–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –Ω–æ —é—Ä–∏—Å—Ç –≤ —à—Ç–∞—Ç–µ –Ω–µ–≤—ã–≥–æ–¥–µ–Ω.\n\n**–ú—ã –≥–æ—Ç–æ–≤–∏–º:**\n‚Ä¢ *–ü—Ä–æ–µ–∫—Ç—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤:* –æ–∫–∞–∑–∞–Ω–∏—è —É—Å–ª—É–≥, –ø–æ–¥—Ä—è–¥–∞, –ø–æ—Å—Ç–∞–≤–∫–∏ —Å –∑–∞—â–∏—Ç–æ–π –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å —É—Å–ª–æ–≤–∏–µ–º –æ–± –æ–ø–ª–∞—Ç–µ).\n‚Ä¢ *–ü—Ä–µ—Ç–µ–Ω–∑–∏–∏:* –∫ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞–º-–¥–æ–ª–∂–Ω–∏–∫–∞–º –¥–ª—è –≤–∑—ã—Å–∫–∞–Ω–∏—è –æ–ø–ª–∞—Ç—ã.\n‚Ä¢ *–ê–∫—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç* –∏ –¥—Ä—É–≥–∏–µ —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã."
}
FAQ_ANSWERS = {
    "price": r"–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ª—é–±–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ ‚Äî *3500 ‚ÇΩ*.\n\n–≠—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞, –≤ –∫–æ—Ç–æ—Ä—É—é —É–∂–µ –≤–∫–ª—é—á–µ–Ω –∞–Ω–∞–ª–∏–∑ –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞ –ò–ò –∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏—Å—Ç–æ–º.",
    "payment_and_delivery": r"–ü—Ä–æ—Ü–µ—Å—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ *–ø–æ–ª–Ω–æ–π –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –∏ –æ–ø–ª–∞—Ç–µ –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç*:\n\n1Ô∏è‚É£ –ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –¥–µ—Ç–∞–ª–µ–π —Å –î–∏—Ä–∏–∂–µ—Ä–æ–º, –º—ã –≥–æ—Ç–æ–≤–∏–º –¥–æ–∫—É–º–µ–Ω—Ç –∏ –ø—Ä–∏—Å—ã–ª–∞–µ–º –≤–∞–º *PDF-–≤–µ—Ä—Å–∏—é —Å –≤–æ–¥—è–Ω—ã–º–∏ –∑–Ω–∞–∫–∞–º–∏* –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.\n2Ô∏è‚É£ *–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–∞—à–µ–≥–æ '–û–ö'*, –≤—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ –æ–ø–ª–∞—Ç—É.\n3Ô∏è‚É£ –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ *—Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ .docx (Word)*.",
    "template": r"–≠—Ç–æ *–Ω–µ —à–∞–±–ª–æ–Ω*.\n\n–ö–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –ò–ò –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –∞ –∑–∞—Ç–µ–º *–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ* –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏ –¥–æ–≤–æ–¥–∏—Ç—Å—è –¥–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞ –∂–∏–≤—ã–º —é—Ä–∏—Å—Ç–æ–º-¬´–î–∏—Ä–∏–∂–µ—Ä–æ–º¬ª.",
    "timing": r"–û–±—ã—á–Ω–æ –æ—Ç *3 –¥–æ 24 —á–∞—Å–æ–≤* —Å –º–æ–º–µ–Ω—Ç–∞, –∫–∞–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ–ª—É—á–∏—Ç –æ—Ç –≤–∞—Å –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.",
    "guarantee": r"–ú—ã *–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º*, —á—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –Ω–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç –±—É–¥–µ—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–∏ –≥—Ä–∞–º–æ—Ç–Ω—ã–º –∏ —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–º. –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å 100% –≤—ã–∏–≥—Ä—ã—à –≤ —Å—É–¥–µ –Ω–µ –º–æ–∂–µ—Ç –Ω–∏ –æ–¥–∏–Ω —é—Ä–∏—Å—Ç."
}
CATEGORY_NAMES = {"civil": "–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ –ø—Ä–∞–≤–æ", "family": "–°–µ–º–µ–π–Ω–æ–µ –ø—Ä–∞–≤–æ", "housing": "–ñ–∏–ª–∏—â–Ω–æ–µ –ø—Ä–∞–≤–æ", "military": "–í–æ–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ", "admin": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∞–≤–æ", "business": "–ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å"}

# --- 3. –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê ---

async def show_main_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
    keyboard = [
        [InlineKeyboardButton("‚úçÔ∏è –í—ã–±—Ä–∞—Ç—å —É—Å–ª—É–≥—É –∏ —Å–≤—è–∑–∞—Ç—å—Å—è", callback_data='show_services_menu')],
        [InlineKeyboardButton("‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)", callback_data='show_faq_menu')],
        [InlineKeyboardButton("‚öñÔ∏è –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", callback_data='show_legal_menu')],
        [InlineKeyboardButton("ü§ù –ù–∞—à —Å–æ—Ä–∞—Ç–Ω–∏–∫: –§–æ–Ω–¥ ¬´–ë—É–¥–µ–º –ñ–∏—Ç—å!¬ª", callback_data='show_partner_fund')],
        [InlineKeyboardButton("üì¢ –ù–∞—à –∫–∞–Ω–∞–ª", url=TELEGRAM_CHANNEL_URL)]
    ]
    text = (
        "*–í–∞—Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç ¬´–ù–µ–π—Ä–æ-–ê–¥–≤–æ–∫–∞—Ç¬ª*\n\n"
        "–ú—ã ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –≤–∏—Ç—Ä–∏–Ω–∞, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ –∏–∑—É—á–∏—Ç—å –Ω–∞—à–∏ —É—Å–ª—É–≥–∏ –∏, –ø—Ä–∏–Ω—è–≤ —Ä–µ—à–µ–Ω–∏–µ, "
        "–Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞—à–∏–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º-¬´–î–∏—Ä–∏–∂–µ—Ä–æ–º¬ª –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã.\n\n"
        "**–ù–∞—à–∞ —Ü–µ–ª—å** ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞–º –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞."
    )
    target = update.callback_query.message if update.callback_query else update.message
    if update.callback_query:
        await target.edit_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode=ParseMode.MARKDOWN)
    else:
        await target.reply_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode=ParseMode.MARKDOWN)

async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    await update.message.reply_text("–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")
    await show_main_menu(update, context)

# --- 4. –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–ù–û–ü–û–ö ---

async def button_handler(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    query = update.callback_query
    await query.answer()
    data = query.data

    manager_url = f"tg://user?id={MANAGER_USER_ID}"

    if data == 'show_services_menu':
        keyboard = [[InlineKeyboardButton(name, callback_data=f'service_{key}')] for key, name in CATEGORY_NAMES.items()]
        keyboard.append([InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", callback_data='back_to_start')])
        await query.edit_message_text("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ñ–µ—Ä—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–º–æ—â—å:", reply_markup=InlineKeyboardMarkup(keyboard))
    
    elif data.startswith('service_'):
        service_key = data.split('_')[1]
        text = SERVICE_DESCRIPTIONS.get(service_key, "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.")
        keyboard = [
            [InlineKeyboardButton("‚úÖ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é", callback_data=f'pre_order_{service_key}')],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ö —Å–ø–∏—Å–∫—É —É—Å–ª—É–≥", callback_data='show_services_menu')]
        ]
        await query.edit_message_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode=ParseMode.MARKDOWN)

    elif data.startswith('pre_order_'):
        service_key = data.split('_')[2]
        category_name = CATEGORY_NAMES.get(service_key, "–≤—ã–±—Ä–∞–Ω–Ω–æ–π —É—Å–ª—É–≥–µ")
        text = (
            f"‚úÖ *–í—ã –≤—ã–±—Ä–∞–ª–∏: {escape_markdown(category_name)}*\n\n"
            "**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî –ø—Ä—è–º–æ–π –¥–∏–∞–ª–æ–≥ —Å –Ω–∞—à–∏–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º-¬´–î–∏—Ä–∏–∂–µ—Ä–æ–º¬ª.**\n\n"
            "–ù–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É ¬´–ù–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥¬ª –Ω–∏–∂–µ, –≤—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –ª–∏—á–Ω—ã–π —á–∞—Ç —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º.\n\n"
            "**–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –±—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –µ–º—É:**\n"
            "1\\. –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ (—Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º).\n"
            "2\\. –í—Å–µ –∏–º–µ—é—â–∏–µ—Å—è –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Ñ–æ—Ç–æ, —Å–∫–∞–Ω—ã, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã).\n\n"
            "_–ù–∞–∂–∏–º–∞—è –∫–Ω–æ–ø–∫—É, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å –Ω–∞—à–µ–π –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é) –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ —É—Å–ª–æ–≤–∏—è –î–æ–≥–æ–≤–æ—Ä–∞ –æ—Ñ–µ—Ä—Ç—ã._"
        )
        keyboard = [
            [InlineKeyboardButton("‚û°Ô∏è –ù–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥ —Å –î–∏—Ä–∏–∂–µ—Ä–æ–º", url=manager_url)],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –æ–ø–∏—Å–∞–Ω–∏—é", callback_data=f'service_{service_key}')]
        ]
        await query.edit_message_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode=ParseMode.MARKDOWN)

    elif data == 'show_faq_menu':
        keyboard = [
            [InlineKeyboardButton("–ö–∞–∫ —è –ø–æ–ª—É—á—É –∏ –æ–ø–ª–∞—á—É –¥–æ–∫—É–º–µ–Ω—Ç?", callback_data='faq_payment_and_delivery')],
            [InlineKeyboardButton("–°–∫–æ–ª—å–∫–æ —Å—Ç–æ—è—Ç —É—Å–ª—É–≥–∏?", callback_data='faq_price')],
            [InlineKeyboardButton("–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —à–∞–±–ª–æ–Ω?", callback_data='faq_template')],
            [InlineKeyboardButton("–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —ç—Ç–æ –∑–∞–π–º–µ—Ç?", callback_data='faq_timing')],
            [InlineKeyboardButton("–ï—Å—Ç—å –ª–∏ –≥–∞—Ä–∞–Ω—Ç–∏–∏?", callback_data='faq_guarantee')],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", callback_data='back_to_start')]
        ]
        await query.edit_message_text("–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –≤–æ–ø—Ä–æ—Å:", reply_markup=InlineKeyboardMarkup(keyboard))
        
    elif data.startswith('faq_'):
        faq_key = data.split('_', 1)[1]
        answer_text = FAQ_ANSWERS.get(faq_key, "–û—Ç–≤–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.")
        keyboard = [[InlineKeyboardButton("‚¨ÖÔ∏è –ö —Å–ø–∏—Å–∫—É –≤–æ–ø—Ä–æ—Å–æ–≤", callback_data='show_faq_menu')]]
        await query.edit_message_text(answer_text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode=ParseMode.MARKDOWN)
        
    elif data == 'show_legal_menu':
        keyboard = [
            [InlineKeyboardButton("üìÑ –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏", callback_data='legal_policy')],
            [InlineKeyboardButton("‚ö†Ô∏è –û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏", callback_data='legal_disclaimer')],
            [InlineKeyboardButton("üìë –î–æ–≥–æ–≤–æ—Ä –ø—É–±–ª–∏—á–Ω–æ–π –æ—Ñ–µ—Ä—Ç—ã", callback_data='legal_oferta')],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", callback_data='back_to_start')]
        ]
        await query.edit_message_text("–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è:", reply_markup=InlineKeyboardMarkup(keyboard))

    elif data.startswith('legal_'):
        text_map = {"legal_policy": LEGAL_POLICY_TEXT, "legal_disclaimer": LEGAL_DISCLAIMER_TEXT, "legal_oferta": LEGAL_OFERTA_TEXT}
        text = text_map.get(data, "–î–æ–∫—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.")
        await query.edit_message_text(text, reply_markup=InlineKeyboardMarkup([
            [InlineKeyboardButton("‚¨ÖÔ∏è –ö —Å–ø–∏—Å–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", callback_data='show_legal_menu')]
        ]), parse_mode=ParseMode.MARKDOWN)

    elif data == 'show_partner_fund':
        text = (
            "ü§ù *–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä—ã–º –º—ã –≥–æ—Ä–¥–∏–º—Å—è*\n\n"
            "–ë–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–æ–Ω–¥ **¬´–ë—É–¥–µ–º –ñ–∏—Ç—å!¬ª** –æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–æ—Ü–µ–Ω–∏–º—É—é –ø–æ–º–æ—â—å –±–æ–π—Ü–∞–º –Ω–∞ –ø–µ—Ä–µ–¥–æ–≤–æ–π –∏ –∏—Ö —Å–µ–º—å—è–º. –ò—Ö —Ä–∞–±–æ—Ç–∞ ‚Äî —ç—Ç–æ –ø—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –¥–µ–ª–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–≤–æ–∏—Ö.\n\n"
            "–ú—ã –≤ ¬´–ù–µ–π—Ä–æ-–ê–¥–≤–æ–∫–∞—Ç–µ¬ª –≥–æ—Ä–¥–∏–º—Å—è —Ç–µ–º, —á—Ç–æ –º–æ–∂–µ–º –±—ã—Ç—å –∏—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º —â–∏—Ç–æ–º –∏ –Ω–∞–¥–µ–∂–Ω—ã–º —Å–æ—Ä–∞—Ç–Ω–∏–∫–æ–º –≤ –±–æ—Ä—å–±–µ –∑–∞ –ø—Ä–∞–≤–∞ –Ω–∞—à–∏—Ö –≥–µ—Ä–æ–µ–≤.\n\n"
            "–ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –∏—Ö —Ä–∞–±–æ—Ç—É. –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å."
        )
        keyboard = [
            [InlineKeyboardButton("‚ñ∂Ô∏è –í–ö–æ–Ω—Ç–∞–∫—Ç–µ", url=PARTNER_VK_URL)],
            [InlineKeyboardButton("‚ñ∂Ô∏è Telegram", url=PARTNER_TG_URL)],
            [InlineKeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", callback_data='back_to_start')]
        ]
        await query.edit_message_text(text, reply_markup=InlineKeyboardMarkup(keyboard), parse_mode=ParseMode.MARKDOWN)

    elif data == 'back_to_start':
        await show_main_menu(update, context)

# --- 5. –ó–ê–ü–£–°–ö –ë–û–¢–ê ---
def main() -> None:
    logger.info("Starting bot version 8.0 'Alliance'...")
    application = Application.builder().token(NEURO_ADVOCAT_TOKEN).build()

    application.add_handler(CommandHandler("start", start_command))
    application.add_handler(CallbackQueryHandler(button_handler))

    async def redirect_to_menu(update: Update, context: ContextTypes.DEFAULT_TYPE):
        await update.message.reply_text("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.")
        await show_main_menu(update, context)

    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, redirect_to_menu))

    logger.info("Application starting polling...")
    application.run_polling()

if __name__ == "__main__":
    main()
